<div class="page m-4 h-full flex flex-col !w-[100dvw]">
  <!--!w-[100rem] -->
  <main class="flex flex-row gap-2">
    <div class="contents">
      <mat-form-field class="example-chip-list w-full">
        <mat-chip-grid #chipGridTag aria-label="Enter fruits">
          @for (tag of tags(); track tag) {
          <mat-chip-row
            (removed)="removeTag(tag)"
            [editable]="true"
            (edited)="editTag(tag, $event)"
            [aria-description]="'press enter to edit ' + tag.name"
          >
            {{ tag.name }}
            <button matChipRemove [attr.aria-label]="'remove ' + tag.name">
              <mat-icon>cancel</mat-icon>
            </button>
          </mat-chip-row>
          }
          <input
            placeholder="Hashtags..."
            [matChipInputFor]="chipGridTag"
            [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
            [matChipInputAddOnBlur]="addOnBlur"
            (matChipInputTokenEnd)="addTag($event)"
          />
        </mat-chip-grid>
      </mat-form-field>
    </div>
    <div class="contents">
      <mat-form-field class="example-chip-list w-full">
        <mat-chip-grid #chipGridPeople aria-label="Enter fruits">
          @for (people of peoples(); track people) {
          <mat-chip-row
            (removed)="removePerson(people)"
            [editable]="true"
            (edited)="editPerson(people, $event)"
            [aria-description]="'press enter to edit ' + people.name"
          >
            {{ people.name }}
            <button matChipRemove [attr.aria-label]="'remove ' + people.name">
              <mat-icon>cancel</mat-icon>
            </button>
          </mat-chip-row>
          }
          <input
            placeholder="People..."
            [matChipInputFor]="chipGridPeople"
            [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
            [matChipInputAddOnBlur]="addOnBlur"
            [matAutocomplete]="auto"
            (input)="onInputChange($event)"
          />
        </mat-chip-grid>
      </mat-form-field>
      <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
        @for (option of users; track option) {
        <mat-option [value]="option.name" (click)="onSelectPerson($event)">{{
          option.name
        }}</mat-option>
        }
      </mat-autocomplete>
    </div>
  </main>
  <div class="flex flex-row justify-between w-full gap-4">
    <div class="grid flex-col gap-4 w-1/4">
      <div class="flex flex-col justify-between gap-4 w-full">
        <!-- <main>
          <div>
            <mat-form-field class="example-chip-list w-full">
              <mat-chip-grid #chipGridTag aria-label="Enter fruits">
                @for (tag of tags(); track tag) {
                <mat-chip-row
                  (removed)="removeTag(tag)"
                  [editable]="true"
                  (edited)="editTag(tag, $event)"
                  [aria-description]="'press enter to edit ' + tag.name"
                >
                  {{ tag.name }}
                  <button
                    matChipRemove
                    [attr.aria-label]="'remove ' + tag.name"
                  >
                    <mat-icon>cancel</mat-icon>
                  </button>
                </mat-chip-row>
                }
                <input
                  placeholder="Hashtags..."
                  [matChipInputFor]="chipGridTag"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                  [matChipInputAddOnBlur]="addOnBlur"
                  (matChipInputTokenEnd)="addTag($event)"
                />
              </mat-chip-grid>
            </mat-form-field>
          </div>
          <div>
            <mat-form-field class="example-chip-list w-full">
              <mat-chip-grid #chipGridPeople aria-label="Enter fruits">
                @for (people of peoples(); track people) {
                <mat-chip-row
                  (removed)="removePerson(people)"
                  [editable]="true"
                  (edited)="editPerson(people, $event)"
                  [aria-description]="'press enter to edit ' + people.name"
                >
                  {{ people.name }}
                  <button
                    matChipRemove
                    [attr.aria-label]="'remove ' + people.name"
                  >
                    <mat-icon>cancel</mat-icon>
                  </button>
                </mat-chip-row>
                }
                <input
                  placeholder="People..."
                  [matChipInputFor]="chipGridPeople"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                  [matChipInputAddOnBlur]="addOnBlur"
                  (matChipInputTokenEnd)="addPerson($event)"
                />
              </mat-chip-grid>
            </mat-form-field>
          </div>
        </main> -->
        <main>
          <button
            type="button"
            (click)="onGenerateDescription()"
            class="mt-4 bgSecond text-white font-medium rounded-lg h-12 w-full cursor-pointer hover:bgSecond transition"
          >
            Generate Description
          </button>

          <button
            type="button"
            (click)="onGenerateTags()"
            class="mt-4 bgSecond text-white font-medium rounded-lg h-12 w-full cursor-pointer hover:bgSecond transition"
          >
            Generate Tags
          </button>

          <button
            type="button"
            (click)="onCheckNSFWText()"
            class="mt-4 bgSecond text-white font-medium rounded-lg h-12 w-full cursor-pointer hover:bgSecond transition"
          >
            Check Text
          </button>

          <button
            type="button"
            class="mt-4 bgSecond text-white font-medium rounded-lg h-12 w-full cursor-pointer hover:bgSecond transition"
            (click)="onTranslate()"
          >
            Translate
          </button>
        </main>
        <main>
          <form [formGroup]="formMedia" class="flex flex-col items-center">
            <label class="file-upload-label" for="file">
              <div
                class="file-upload-design flex flex-col items-center p-4 border rounded-md cursor-pointer"
                [class.opacity-50]="mediaFiles.length > numberOfImages"
              >
                <svg height="1em" viewBox="0 0 640 512" class="mb-2">
                  <path
                    d="M144 480C64.5 480 0 415.5 0 336c0-62.8 40.2-116.2 96.2-135.9c-.1-2.7-.2-5.4-.2-8.1c0-88.4 71.6-160 160-160c59.3 0 111 32.2 138.7 80.2C409.9 102 428.3 96 448 96c53 0 96 43 96 96c0 12.2-2.3 23.8-6.4 34.6C596 238.4 640 290.1 640 352c0 70.7-57.3 128-128 128H144zm79-217c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l39-39V392c0 13.3 10.7 24 24 24s24-10.7 24-24V257.9l39 39c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-80-80c-9.4-9.4-24.6-9.4-33.9 0l-80 80z"
                  ></path>
                </svg>
                <span class="browse-button text-blue-500 font-semibold"> </span>
              </div>
              <input
                id="file"
                formControlName="media"
                type="file"
                accept="image/*,video/*,audio/*"
                (change)="onFileSelected($event)"
                class="hidden"
              />
            </label>
          </form>
        </main>
      </div>
    </div>

    <div class="flex flex-col w-full gap-4">
      <div class="flex-auto flex flex-col justify-around">
        @if(imagePreview !== null){
        <img
          [src]="imagePreview"
          class="h-[67dvh] p-2 object-contain"
          crossorigin="anonymous"
          draggable="false"
        />
        }@else {
        <!-- <div class="main_wrapper ">
          <div class="main">
            <div class="antenna">
              <div class="antenna_shadow"></div>
              <div class="a1"></div>
              <div class="a1d"></div>
              <div class="a2"></div>
              <div class="a2d"></div>
              <div class="a_base"></div>
            </div>
            <div class="tv">
              <div class="cruve">
                <svg
                  class="curve_svg"
                  version="1.1"
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  viewBox="0 0 189.929 189.929"
                  xml:space="preserve"
                >
                  <path
                    d="M70.343,70.343c-30.554,30.553-44.806,72.7-39.102,115.635l-29.738,3.951C-5.442,137.659,11.917,86.34,49.129,49.13
        C86.34,11.918,137.664-5.445,189.928,1.502l-3.95,29.738C143.041,25.54,100.895,39.789,70.343,70.343z"
                  ></path>
                </svg>
              </div>
              <div class="display_div">
                <div class="screen_out">
                  <div class="screen_out1">
                    <div class="screen">
                      <span class="notfound_text"> NOT FOUND</span>
                    </div>
                    <div class="screenM">
                      <span class="notfound_text"> NOT FOUND</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="lines">
                <div class="line1"></div>
                <div class="line2"></div>
                <div class="line3"></div>
              </div>
              <div class="buttons_div">
                <div class="b1"><div></div></div>
                <div class="b2"></div>
                <div class="speakers">
                  <div class="g1">
                    <div class="g11"></div>
                    <div class="g12"></div>
                    <div class="g13"></div>
                  </div>
                  <div class="g"></div>
                  <div class="g"></div>
                </div>
              </div>
            </div>
            <div class="bottom">
              <div class="base1"></div>
              <div class="base2"></div>
              <div class="base3"></div>
            </div>
          </div>
          <div class="text_404">
            <div class="text_4041">4</div>
            <div class="text_4042">0</div>
            <div class="text_4043">4</div>
          </div>
        </div> -->
        <div class="max-w-lg w-[40rem] h-[67dvh] object-contain"></div>
        }
        <form [formGroup]="formPost" class="flex flex-col gap-4 w-full">
          <div
            class="flex items-center border border-gray-700 rounded-lg h-40 px-3 transition focus-within:border-efec bg-[#2b2b2b]"
          >
            <textarea
              formControlName="text"
              class="ml-3 w-full h-36 bg-[#2b2b2b] textSecond border-none focus:outline-none placeholder-gray-400"
              placeholder="What's on your mind?"
            ></textarea>
          </div>
        </form>
      </div>
    </div>

    <div
      class="flex flex-col w-1/4 max-h-[95dvh] justify-between gap-2 items-center"
    >
      <main
        class="flex flex-col overflow-auto max-h-[78dvh] gap-2 no-scrollbar items-center"
      >
        <div class="stack" *ngFor="let image of mediaFiles; let k = index">
          <div class="card" (click)="onSelectImage(k)">
            <div class="image">
              <img
                [src]="image"
                alt="image"
                class="w-full h-auto object-contain rounded-md"
              />
            </div>
          </div>
        </div>
      </main>

      <button
        type="button"
        (click)="onSavePost()"
        class="mt-4 bgSecond text-white font-medium rounded-lg h-12 w-full cursor-pointer hover:bgSecond transition"
      >
        Save Post
      </button>
    </div>
  </div>
</div>
<lib-alert
  class="absolute top-4 left-1/2 z-50 transform -translate-x-1/2"
  *ngIf="showAlert"
  [message]="alertMessage"
  [subject]="errorMessage"
  [mode]="mode"
  (handleChangeValue)="showAlert = false"
></lib-alert>
